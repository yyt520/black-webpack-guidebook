<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no"
    />
    <link rel="shortcut icon" type="image/x-icon" href="./favicon.ico" />
    <link rel="stylesheet" href="/black-webpack-guidebook/umi.3dfdd0be.css" />
    <script>
      window.routerBase = "/black-webpack-guidebook/";
    </script>
    <script>
      //! umi version: 3.5.41
    </script>
    <script>
      !(function () {
        var e =
            navigator.cookieEnabled && void 0 !== window.localStorage
              ? localStorage.getItem("dumi:prefers-color")
              : "auto",
          o = window.matchMedia("(prefers-color-scheme: dark)").matches,
          t = ["light", "dark", "auto"];
        document.documentElement.setAttribute(
          "data-prefers-color",
          e === t[2] ? (o ? t[1] : t[0]) : t.indexOf(e) > -1 ? e : t[0]
        );
      })();
    </script>
    <title>plugins 插件 - Webpack Guidebook</title>
  </head>
  <body>
    <div id="root"><div class="__dumi-default-layout" data-route="/basic/core/plugins" data-show-sidemenu="true" data-show-slugs="true" data-site-mode="true" data-gapless="false"><div class="__dumi-default-navbar" data-mode="site"><button class="__dumi-default-navbar-toggle"></button><a class="__dumi-default-navbar-logo" style="background-image:url(&#x27;http://img.mrsingsing.com/webpack-guidebook-favicon.svg&#x27;)" href="/black-webpack-guidebook//">Webpack Guidebook</a><nav><div class="__dumi-default-search"><input type="search" class="__dumi-default-search-input" value=""/><ul></ul></div><span><a aria-current="page" class="active" href="/black-webpack-guidebook//basic">基本综述</a></span><span><a href="/black-webpack-guidebook//infra">架构原理</a></span><span><a href="/black-webpack-guidebook//best-practice">最佳实践</a></span><span><a target="_blank" rel="noopener noreferrer" href="https://github.com/yyt520/black-webpack-guidebook">Github<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></span><div class="__dumi-default-navbar-tool"><div class="__dumi-default-dark"><div class="__dumi-default-dark-switch "></div></div></div></nav></div><div class="__dumi-default-menu" data-mode="site"><div class="__dumi-default-menu-inner"><div class="__dumi-default-menu-header"><a class="__dumi-default-menu-logo" style="background-image:url(&#x27;http://img.mrsingsing.com/webpack-guidebook-favicon.svg&#x27;)" href="/black-webpack-guidebook//"></a><h1>Webpack Guidebook</h1><p>Webpack 完全知识体系</p></div><div class="__dumi-default-menu-mobile-area"><ul class="__dumi-default-menu-nav-list"><li><a aria-current="page" class="active" href="/black-webpack-guidebook//basic">基本综述</a></li><li><a href="/black-webpack-guidebook//infra">架构原理</a></li><li><a href="/black-webpack-guidebook//best-practice">最佳实践</a></li><li><a target="_blank" rel="noopener noreferrer" href="https://github.com/yyt520/black-webpack-guidebook">Github<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul><div class="__dumi-default-dark"><div class="__dumi-default-dark-switch "><button title="Dark theme" class="__dumi-default-dark-moon "><svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3854" width="22" height="22"><path d="M991.816611 674.909091a69.166545 69.166545 0 0 0-51.665455-23.272727 70.795636 70.795636 0 0 0-27.438545 5.585454A415.674182 415.674182 0 0 1 754.993338 698.181818c-209.594182 0-393.472-184.785455-393.472-395.636363 0-52.363636 38.539636-119.621818 69.515637-173.614546 4.887273-8.610909 9.634909-16.756364 14.103272-24.901818A69.818182 69.818182 0 0 0 384.631156 0a70.842182 70.842182 0 0 0-27.438545 5.585455C161.678429 90.298182 14.362065 307.898182 14.362065 512c0 282.298182 238.824727 512 532.38691 512a522.286545 522.286545 0 0 0 453.957818-268.334545A69.818182 69.818182 0 0 0 991.816611 674.909091zM546.679156 954.181818c-248.785455 0-462.941091-192-462.941091-442.181818 0-186.647273 140.637091-372.829091 300.939637-442.181818-36.817455 65.629091-92.578909 151.970909-92.578909 232.727273 0 250.181818 214.109091 465.454545 462.917818 465.454545a488.331636 488.331636 0 0 0 185.181091-46.545455 453.003636 453.003636 0 0 1-393.565091 232.727273z m103.656728-669.323636l-14.266182 83.781818a34.909091 34.909091 0 0 0 50.362182 36.770909l74.775272-39.563636 74.752 39.563636a36.142545 36.142545 0 0 0 16.174546 3.956364 34.909091 34.909091 0 0 0 34.210909-40.727273l-14.289455-83.781818 60.509091-59.345455a35.025455 35.025455 0 0 0-19.223272-59.578182l-83.61891-12.101818-37.376-76.101818a34.56 34.56 0 0 0-62.254545 0l-37.376 76.101818-83.618909 12.101818a34.909091 34.909091 0 0 0-19.246546 59.578182z m70.423272-64.698182a34.280727 34.280727 0 0 0 26.135273-19.083636l14.312727-29.090909 14.336 29.090909a34.257455 34.257455 0 0 0 26.135273 19.083636l32.046546 4.887273-23.272728 22.574545a35.234909 35.234909 0 0 0-10.007272 30.952727l5.46909 32.116364-28.625454-15.127273a34.490182 34.490182 0 0 0-32.302546 0l-28.695272 15.127273 5.469091-32.116364a35.141818 35.141818 0 0 0-9.984-30.952727l-23.272728-22.574545z" p-id="3855"></path></svg></button><button title="Light theme" class="__dumi-default-dark-sun "><svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4026" width="22" height="22"><path d="M915.2 476.16h-43.968c-24.704 0-44.736 16-44.736 35.84s20.032 35.904 44.736 35.904H915.2c24.768 0 44.8-16.064 44.8-35.904s-20.032-35.84-44.8-35.84zM512 265.6c-136.704 0-246.464 109.824-246.464 246.4 0 136.704 109.76 246.464 246.464 246.464S758.4 648.704 758.4 512c0-136.576-109.696-246.4-246.4-246.4z m0 425.6c-99.008 0-179.2-80.128-179.2-179.2 0-98.944 80.192-179.2 179.2-179.2S691.2 413.056 691.2 512c0 99.072-80.192 179.2-179.2 179.2zM197.44 512c0-19.84-19.136-35.84-43.904-35.84H108.8c-24.768 0-44.8 16-44.8 35.84s20.032 35.904 44.8 35.904h44.736c24.768 0 43.904-16.064 43.904-35.904zM512 198.464c19.776 0 35.84-20.032 35.84-44.8v-44.8C547.84 84.032 531.84 64 512 64s-35.904 20.032-35.904 44.8v44.8c0 24.768 16.128 44.864 35.904 44.864z m0 627.136c-19.776 0-35.904 20.032-35.904 44.8v44.736C476.096 940.032 492.16 960 512 960s35.84-20.032 35.84-44.8v-44.736c0-24.768-16.064-44.864-35.84-44.864z m329.92-592.832c17.472-17.536 20.288-43.072 6.4-57.024-14.016-14.016-39.488-11.2-57.024 6.336-4.736 4.864-26.496 26.496-31.36 31.36-17.472 17.472-20.288 43.008-6.336 57.024 13.952 14.016 39.488 11.2 57.024-6.336 4.8-4.864 26.496-26.56 31.296-31.36zM213.376 759.936c-4.864 4.8-26.56 26.624-31.36 31.36-17.472 17.472-20.288 42.944-6.4 56.96 14.016 13.952 39.552 11.2 57.024-6.336 4.8-4.736 26.56-26.496 31.36-31.36 17.472-17.472 20.288-43.008 6.336-56.96-14.016-13.952-39.552-11.072-56.96 6.336z m19.328-577.92c-17.536-17.536-43.008-20.352-57.024-6.336-14.08 14.016-11.136 39.488 6.336 57.024 4.864 4.864 26.496 26.56 31.36 31.424 17.536 17.408 43.008 20.288 56.96 6.336 14.016-14.016 11.264-39.488-6.336-57.024-4.736-4.864-26.496-26.56-31.296-31.424z m527.168 628.608c4.864 4.864 26.624 26.624 31.36 31.424 17.536 17.408 43.072 20.224 57.088 6.336 13.952-14.016 11.072-39.552-6.4-57.024-4.864-4.8-26.56-26.496-31.36-31.36-17.472-17.408-43.072-20.288-57.024-6.336-13.952 14.016-11.008 39.488 6.336 56.96z" p-id="4027"></path></svg></button><button title="Default to system" class="__dumi-default-dark-auto "><svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="11002" width="22" height="22"><path d="M127.658667 492.885333c0-51.882667 10.24-101.717333 30.378666-149.162666s47.786667-88.064 81.92-122.538667 75.093333-61.781333 122.538667-81.92 96.938667-30.378667 149.162667-30.378667 101.717333 10.24 149.162666 30.378667 88.405333 47.786667 122.88 81.92 61.781333 75.093333 81.92 122.538667 30.378667 96.938667 30.378667 149.162666-10.24 101.717333-30.378667 149.162667-47.786667 88.405333-81.92 122.88-75.093333 61.781333-122.88 81.92-97.28 30.378667-149.162666 30.378667-101.717333-10.24-149.162667-30.378667-88.064-47.786667-122.538667-81.92-61.781333-75.093333-81.92-122.88-30.378667-96.938667-30.378666-149.162667z m329.045333 0c0 130.048 13.994667 244.394667 41.984 343.381334h12.970667c46.762667 0 91.136-9.216 133.461333-27.306667s78.848-42.666667 109.568-73.386667 54.954667-67.242667 73.386667-109.568 27.306667-86.698667 27.306666-133.461333c0-46.421333-9.216-90.794667-27.306666-133.12s-42.666667-78.848-73.386667-109.568-67.242667-54.954667-109.568-73.386667-86.698667-27.306667-133.461333-27.306666h-11.605334c-28.672 123.562667-43.349333 237.909333-43.349333 343.722666z" p-id="11003"></path></svg></button></div></div></div><ul class="__dumi-default-menu-list"><li><a target="_blank" rel="noopener noreferrer">基本概念</a><ul><li><a href="/black-webpack-guidebook//basic/modularization"><span>模块化</span></a></li><li><a href="/black-webpack-guidebook//basic/build-tool"><span>构建工具</span></a></li><li><a href="/black-webpack-guidebook//basic/grunt"><span>Grunt</span></a></li><li><a href="/black-webpack-guidebook//basic/gulp"><span>Gulp</span></a></li><li><a href="/black-webpack-guidebook//basic/rollup"><span>Rollup</span></a></li><li><a href="/black-webpack-guidebook//basic/parcel"><span>Parcel</span></a></li><li><a href="/black-webpack-guidebook//basic/webpack"><span>Webpack</span></a></li></ul></li><li><a target="_blank" rel="noopener noreferrer">核心概念</a><ul><li><a href="/black-webpack-guidebook//basic/core/mode"><span>mode 模式</span></a></li><li><a href="/black-webpack-guidebook//basic/core/entry"><span>entry 输入</span></a></li><li><a href="/black-webpack-guidebook//basic/core/output"><span>output 输出</span></a></li><li><a href="/black-webpack-guidebook//basic/core/resolve"><span>resolve 解析</span></a></li><li><a href="/black-webpack-guidebook//basic/core/module"><span>module 模块</span></a></li><li><a href="/black-webpack-guidebook//basic/core/optimization"><span>optimization 优化</span></a></li><li><a aria-current="page" class="active" href="/black-webpack-guidebook//basic/core/plugins"><span>plugins 插件</span></a></li><li><a href="/black-webpack-guidebook//basic/core/cache"><span>cache 缓存</span></a></li><li><a href="/black-webpack-guidebook//basic/core/dev-server"><span>devServer 开发服务器</span></a></li><li><a href="/black-webpack-guidebook//basic/core/other-options"><span>其他配置</span></a></li></ul></li></ul></div></div><ul role="slug-list" class="__dumi-default-layout-toc"><li title="内置插件" data-depth="2"><a href="/black-webpack-guidebook//basic/core/plugins#内置插件"><span>内置插件</span></a></li><li title="常用插件" data-depth="2"><a href="/black-webpack-guidebook//basic/core/plugins#常用插件"><span>常用插件</span></a></li><li title="SplitChunksPlugin" data-depth="3"><a href="/black-webpack-guidebook//basic/core/plugins#splitchunksplugin"><span>SplitChunksPlugin</span></a></li><li title="DefinePlugin" data-depth="3"><a href="/black-webpack-guidebook//basic/core/plugins#defineplugin"><span>DefinePlugin</span></a></li><li title="DllPlugin" data-depth="3"><a href="/black-webpack-guidebook//basic/core/plugins#dllplugin"><span>DllPlugin</span></a></li><li title="IgnorePlugin" data-depth="3"><a href="/black-webpack-guidebook//basic/core/plugins#ignoreplugin"><span>IgnorePlugin</span></a></li><li title="HotModuleReplacementPlugin" data-depth="3"><a href="/black-webpack-guidebook//basic/core/plugins#hotmodulereplacementplugin"><span>HotModuleReplacementPlugin</span></a></li><li title="WebpackBundleAnalyzer" data-depth="3"><a href="/black-webpack-guidebook//basic/core/plugins#webpackbundleanalyzer"><span>WebpackBundleAnalyzer</span></a></li><li title="内部插件" data-depth="3"><a href="/black-webpack-guidebook//basic/core/plugins#内部插件"><span>内部插件</span></a></li><li title="社区生态" data-depth="2"><a href="/black-webpack-guidebook//basic/core/plugins#社区生态"><span>社区生态</span></a></li><li title="HtmlWebpackPlugin" data-depth="3"><a href="/black-webpack-guidebook//basic/core/plugins#htmlwebpackplugin"><span>HtmlWebpackPlugin</span></a></li><li title="PreloadWebpackPlugin" data-depth="3"><a href="/black-webpack-guidebook//basic/core/plugins#preloadwebpackplugin"><span>PreloadWebpackPlugin</span></a></li><li title="HtmlMinimizerWebpackPlugin" data-depth="3"><a href="/black-webpack-guidebook//basic/core/plugins#htmlminimizerwebpackplugin"><span>HtmlMinimizerWebpackPlugin</span></a></li><li title="CssMinimizerWebpackPlugin" data-depth="3"><a href="/black-webpack-guidebook//basic/core/plugins#cssminimizerwebpackplugin"><span>CssMinimizerWebpackPlugin</span></a></li><li title="MiniCssExtractPlugin" data-depth="3"><a href="/black-webpack-guidebook//basic/core/plugins#minicssextractplugin"><span>MiniCssExtractPlugin</span></a></li><li title="ImageMinimizerWebpackPlugin" data-depth="3"><a href="/black-webpack-guidebook//basic/core/plugins#imageminimizerwebpackplugin"><span>ImageMinimizerWebpackPlugin</span></a></li><li title="TerserWebpackPlugin" data-depth="3"><a href="/black-webpack-guidebook//basic/core/plugins#terserwebpackplugin"><span>TerserWebpackPlugin</span></a></li><li title="CompressionWebpackPlugin" data-depth="3"><a href="/black-webpack-guidebook//basic/core/plugins#compressionwebpackplugin"><span>CompressionWebpackPlugin</span></a></li><li title="CopyWebpackPlugin" data-depth="3"><a href="/black-webpack-guidebook//basic/core/plugins#copywebpackplugin"><span>CopyWebpackPlugin</span></a></li><li title="废弃插件" data-depth="2"><a href="/black-webpack-guidebook//basic/core/plugins#废弃插件"><span>废弃插件</span></a></li><li title="CommonsChunkPlugin" data-depth="3"><a href="/black-webpack-guidebook//basic/core/plugins#commonschunkplugin"><span>CommonsChunkPlugin</span></a></li><li title="UglifyjsWebpackPlugin" data-depth="3"><a href="/black-webpack-guidebook//basic/core/plugins#uglifyjswebpackplugin"><span>UglifyjsWebpackPlugin</span></a></li></ul><div class="__dumi-default-layout-content"><div class="markdown"><h1 id="plugins-插件"><a aria-hidden="true" tabindex="-1" href="/black-webpack-guidebook//basic/core/plugins#plugins-插件"><span class="icon icon-link"></span></a>plugins 插件</h1><p><a target="_blank" rel="noopener noreferrer" href="https://webpack.js.org/configuration/plugins/">Plugins<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p><p>用于扩展 Webpack 功能。</p><p>使用 Plugin 的难点在于掌握 Plugin 本身提供的配置项，而不是如何在 Webpack 中接入 Plugin。</p><h2 id="内置插件"><a aria-hidden="true" tabindex="-1" href="/black-webpack-guidebook//basic/core/plugins#内置插件"><span class="icon icon-link"></span></a>内置插件</h2><div class="__dumi-default-table"><div class="__dumi-default-table-content"><table><thead><tr><th align="left">插件</th><th align="left">说明</th><th align="left">版本</th></tr></thead><tbody><tr><td align="left"><code>AutomaticPrefetchPlugin</code></td><td align="left">观察之前编译的 <strong>所有模块</strong> 的变化，以改进增量构建的时间</td><td align="left"></td></tr><tr><td align="left"><code>BannerPlugin</code></td><td align="left">为每个 <code>chunk</code> 文件头部添加 <code>banner</code></td><td align="left"></td></tr><tr><td align="left"><code>CommonsChunkPlugin</code></td><td align="left">用于创建一个独立文件，这个文件包括多个入口 <code>chunk</code> 的公共模块</td><td align="left"></td></tr><tr><td align="left"><code>ContextExclusionPlugin</code></td><td align="left">用于排除与其正则匹配的所有上下文</td><td align="left">v5+</td></tr><tr><td align="left"><code>ContextReplacementPlugin</code></td><td align="left">用于覆盖推断的目录和正则表达式</td><td align="left"></td></tr><tr><td align="left"><code>DefinePlugin</code></td><td align="left">用于在编译时用其他值或表达式替换代码中的变量</td><td align="left"></td></tr><tr><td align="left"><code>DllPlugin</code></td><td align="left">用于拆分 <code>bundles</code>，可以极大地提高构建时的性能</td><td align="left"></td></tr><tr><td align="left"><code>EnvironmentPlugin</code></td><td align="left">用于在 <code>process.env</code> 键上使用 DefinePlugin 的简写</td><td align="left"></td></tr><tr><td align="left"><code>EvalSourceMapDevToolPlugin</code></td><td align="left">支持对 SourceMap 生成更细粒度的控制（可通过 <code>devtool</code> 配置选项自动启用）</td><td align="left"></td></tr><tr><td align="left"><code>HashedModuleIdsPlugin</code></td><td align="left">用于支持 <code>hash</code> 基于模块的相对路径，生成一个四个字符的字符串作为模块 <code>id</code></td><td align="left"></td></tr><tr><td align="left"><code>HotModuleReplacementPlugin</code></td><td align="left">启用热模块更换</td><td align="left"></td></tr><tr><td align="left"><code>IgnorePlugin</code></td><td align="left">用于忽略与正则表达式或筛选函数匹配的 <code>import</code> 或 <code>require</code> 调用模块</td><td align="left"></td></tr><tr><td align="left"><code>LimitChunkCountPlugin</code></td><td align="left">用于编译后期合并体积过小的块，以减少 HTTP 开销</td><td align="left"></td></tr><tr><td align="left"><code>MinChunkSizePlugin</code></td><td align="left">用于合并低于指定大小的块</td><td align="left"></td></tr><tr><td align="left"><code>ModuleConcatenationPlugin</code></td><td align="left">用于在 Webpack 中启用提升或将所有模块的作用域连接到一个闭包中</td><td align="left"></td></tr><tr><td align="left"><code>ModuleFederationPlugin</code></td><td align="left">允许在运行时提供或使用其他独立构件的模块</td><td align="left"></td></tr><tr><td align="left"><code>NoEmitOnErrorsPlugin</code></td><td align="left">允许在出现任何异常时避免释放资产</td><td align="left"></td></tr><tr><td align="left"><code>NormalModuleReplacementPlugin</code></td><td align="left">用于指定路径的资源替换正则匹配的资源</td><td align="left"></td></tr><tr><td align="left"><code>PrefetchPlugin</code></td><td align="left">预加载模块，在首次 <code>import</code> 或 <code>require</code> 之前解析和构建（应先尝试分析构建以确认明确的预加载节点）</td><td align="left"></td></tr><tr><td align="left"><code>ProfilingPlugin</code></td><td align="left">用于生成包含插件执行时间的 Chrome 配置文件</td><td align="left"></td></tr><tr><td align="left"><code>ProgressPlugin</code></td><td align="left">提供一种自定义在编译期间如何报告进度的方式</td><td align="left"></td></tr><tr><td align="left"><code>ProvidePlugin</code></td><td align="left">自动加载模块，无需到处 <code>import</code> 或 <code>require</code></td><td align="left"></td></tr><tr><td align="left"><code>SourceMapDevToolPlugin</code></td><td align="left">用于更精细地控制 SourceMap 的生成</td><td align="left"></td></tr><tr><td align="left"><code>SplitChunksPlugin</code></td><td align="left">用于避免依赖图中父子重复依赖关系</td><td align="left">v4-</td></tr><tr><td align="left"><code>WatchIgnorePlugin</code></td><td align="left">在监视模式下，忽略指定的文件，即与提供的路径活正则表达式匹配的文件</td><td align="left"></td></tr><tr><td align="left">内部插件</td><td align="left"></td><td align="left"></td></tr></tbody></table></div></div><h2 id="常用插件"><a aria-hidden="true" tabindex="-1" href="/black-webpack-guidebook//basic/core/plugins#常用插件"><span class="icon icon-link"></span></a>常用插件</h2><h3 id="splitchunksplugin"><a aria-hidden="true" tabindex="-1" href="/black-webpack-guidebook//basic/core/plugins#splitchunksplugin"><span class="icon icon-link"></span></a>SplitChunksPlugin</h3><p>最初，块（Chunks）及其内部导入模块是通过 Webpack 内部的依赖关系图的父子关系连接起来的，用于提取公共模块。从 Webpack v4+ 开始，<a href="/black-webpack-guidebook//basic/core/plugins#commonschunkplugin">CommonsChunkPlugin</a> 已被删除，转而使用 <code>optimization.splitChunks</code>。</p><p>默认情况下 Webpack 会按照下列条件自动分割 Chunks：</p><ul><li>可以共享新的 Chunk，或者模块来自 <code>node_modules</code> 文件夹</li><li>新的 Chunk 将大于 30kb（在 mini + gzip 之前）</li><li>当需要加载 Chunk 时，并行请求的最大数量将小雨或等于 30 个</li><li>初始页面加载时的最大并行请求数将低于或等于 30 次</li></ul><p>配置示例：</p><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">module</span><span class="token punctuation">.</span><span class="token property-access">exports</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token literal-property property">optimization</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token literal-property property">splitChunks</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token comment">// 拆分出来块的名字（Chunk Names）默认由块名和 hash 值自动生成</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token comment">// name: &lt;chunk name&gt;,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token comment">// 表示显示块的范围，三个可选值 all（全部块）、async（按需加载块）和initial（初始块）</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token literal-property property">chunks</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&#x27;async&#x27;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token comment">// 表示在压缩前的最小模块大小（默认为 0）</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token literal-property property">minSize</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">20000</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token literal-property property">minRemainingSize</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token comment">// 表示被引用次数（默认为 1）</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token literal-property property">minChunks</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token comment">// 按需加载时的最大并行请求数（默认为 1）</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token literal-property property">maxAsyncRequest</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">30</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token comment">// 最大的初始化加载次数（默认为 1）</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token literal-property property">maxInitialRequests</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">30</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token literal-property property">enforceSizwThreshold</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">50000</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token comment">// 缓存组</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token literal-property property">cacheGroups</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token literal-property property">defaultVendors</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">          </span><span class="token comment">// 缓存组的规则，表示符合条件的放入当前缓存组，值可是字符串、布尔值、函数或正则表达式（默认为空）</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">          </span><span class="token literal-property property">test</span><span class="token operator">:</span><span class="token plain"> </span><span class="token regex regex-delimiter">/</span><span class="token regex regex-source language-regex">[\\/]node_modules[\\/]</span><span class="token regex regex-delimiter">/</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">          </span><span class="token comment">// 表示缓存的优先级</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">          </span><span class="token literal-property property">priority</span><span class="token operator">:</span><span class="token plain"> </span><span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">          </span><span class="token comment">// 表示可以使用已经存在的块，即如果满足条件的块已经存在就使用已有的，不再创建一个新的块</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">          </span><span class="token literal-property property">reuseExistingChunk</span><span class="token operator">:</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token keyword module">default</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">          </span><span class="token literal-property property">minChunks</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">2</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">          </span><span class="token literal-property property">priority</span><span class="token operator">:</span><span class="token plain"> </span><span class="token operator">-</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">          </span><span class="token literal-property property">reuseExistingChunk</span><span class="token operator">:</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">;</span></div></pre></div><p>注意：</p><ul><li>当 Webpack 处理文件路径时，它们在 Unix 系统上始终包含 <code>/</code>，在 Windows 上始终包含 <code>\</code>。因此，必须在 <code>cacheGroup.test</code> 字段中使用 <code>[\\/]</code> 来表示路径分隔符。在跨平台使用时，<code>cacheGroups.test</code> 中的 <code>/</code> 或 <code>\</code> 将导致问题</li><li>Webpack5 开始，不再允许将条目名称传递给 <code>cacheGroup.test</code> 并使用现有 Chunk 的名称作为 <code>cacheGroup.name</code></li></ul><h3 id="defineplugin"><a aria-hidden="true" tabindex="-1" href="/black-webpack-guidebook//basic/core/plugins#defineplugin"><span class="icon icon-link"></span></a>DefinePlugin</h3><p>DefinePlugin 在 <strong>编译</strong> 时用其他值或表达式替换代码中的变量。这对于允许开发构建和生产构建之间的不同行为非常有用。如果在开发构建中执行日志记录，而不是在生产构建中执行日志记录，则可以使用全局常量来确定是否进行日志记录。这就是 DefinePlugin 的特性，为开发和生产构建设设置不同的规则。</p><p>传递到 DefinePlugin 中的每个键都是一个标识或多个相连的标识符。</p><ul><li>如果值时一个字符串，它将被用作一个代码片段</li><li>如果值不是字符串，它将被字符串化（<code>JSON.stringify</code>）包括函数</li><li>如果值是一个对象，所有键的定义方式都是一样的</li><li>如果将 <code>typeof</code> 前缀作为键，则仅为 <code>typeof</code> 调用定义</li></ul><p>配置示例：</p><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token keyword">new</span><span class="token plain"> </span><span class="token class-name">webpack</span><span class="token class-name punctuation">.</span><span class="token class-name">DefinePlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token constant">PRODUCTION</span><span class="token operator">:</span><span class="token plain"> </span><span class="token known-class-name class-name">JSON</span><span class="token punctuation">.</span><span class="token method function property-access">stringify</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token constant">VERSION</span><span class="token operator">:</span><span class="token plain"> </span><span class="token known-class-name class-name">JSON</span><span class="token punctuation">.</span><span class="token method function property-access">stringify</span><span class="token punctuation">(</span><span class="token string">&#x27;5fa3b9&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token constant">BROWSER_SUPPORTS_HTML5</span><span class="token operator">:</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token constant">TWO</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&#x27;1+1&#x27;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token string-property property">&#x27;typeof window&#x27;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token known-class-name class-name">JSON</span><span class="token punctuation">.</span><span class="token method function property-access">stringify</span><span class="token punctuation">(</span><span class="token string">&#x27;object&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token string-property property">&#x27;process.env.NODE_ENV&#x27;</span><span class="token operator">:</span><span class="token plain"> </span><span class="token known-class-name class-name">JSON</span><span class="token punctuation">.</span><span class="token method function property-access">stringify</span><span class="token punctuation">(</span><span class="token plain">process</span><span class="token punctuation">.</span><span class="token property-access">env</span><span class="token punctuation">.</span><span class="token constant">NODE_ENV</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token comment">// 在生产/开发构建中使用不同的服务 URL</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token constant">SERVICE_URL</span><span class="token operator">:</span><span class="token plain"> </span><span class="token known-class-name class-name">JSON</span><span class="token punctuation">.</span><span class="token method function property-access">stringify</span><span class="token punctuation">(</span><span class="token string">&#x27;https://dev.example.com&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div></pre></div><p>代码示例：</p><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">&#x27;Running App version &#x27;</span><span class="token plain"> </span><span class="token operator">+</span><span class="token plain"> </span><span class="token constant">VERSION</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token keyword control-flow">if</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token constant">BROWSER_SUPPORTS_HTML5</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;html5shiv&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div></pre></div><p>注意事项：</p><ul><li>在为 <code>process</code> 定义值时，最好使用 <code>process.env.NODE_ENV: JSON.stringify(&#x27;production&#x27;)</code> 而非 <code>process: <!-- -->{<!-- --> env: <!-- -->{<!-- --> NODE_ENV: JSON.stringify(&#x27;production&#x27;) <!-- -->}<!-- --> <!-- -->}</code>，使用后者将覆盖 <code>process</code> 对象，这可能会破坏构建过程对象上定义其他值的某些模块的兼容性</li><li>请注意，由于该插件会直接替换文本，因此为其提供的值必须在字符串本身内部包含实际引号。通常，这可以通过使用引号（例如 <code>&#x27;&quot;production&quot;&#x27;</code> ）或使用 <code>JSON.stringify(&#x27;production&#x27;)</code> 来完成。</li></ul><h4 id="运行时值"><a aria-hidden="true" tabindex="-1" href="/black-webpack-guidebook//basic/core/plugins#运行时值"><span class="icon icon-link"></span></a>运行时值</h4><p>通过 <code>runtimeValue</code> 生成运行时值，可以定义一些依赖于文件的变量，当文件系统中的文件发生变化时，这些变量将被重新评估。这意味着当这些被监视的文件发生变化时，Webpack 将重建。</p><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token keyword">const</span><span class="token plain"> fileDep </span><span class="token operator">=</span><span class="token plain"> path</span><span class="token punctuation">.</span><span class="token method function property-access">resolve</span><span class="token punctuation">(</span><span class="token plain">__dirname</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&#x27;sample.txt&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">new</span><span class="token plain"> </span><span class="token class-name">webpack</span><span class="token class-name punctuation">.</span><span class="token class-name">DefinePlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token constant">BUILT_AT</span><span class="token operator">:</span><span class="token plain"> webpack</span><span class="token punctuation">.</span><span class="token property-access maybe-class-name">DefinePlugin</span><span class="token punctuation">.</span><span class="token method function property-access">runtimeValue</span><span class="token punctuation">(</span><span class="token known-class-name class-name">Date</span><span class="token punctuation">.</span><span class="token property-access">now</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token literal-property property">fileDependencies</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token plain">fileDep</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div></pre></div><p><code>BUILT_AT</code> 的值将是文件系统中 <code>sample.txt</code> 最后更新时间，例如 <code>1597953013291</code>。</p><h3 id="dllplugin"><a aria-hidden="true" tabindex="-1" href="/black-webpack-guidebook//basic/core/plugins#dllplugin"><span class="icon icon-link"></span></a>DllPlugin</h3><blockquote><p>DLL（Dynamic Link Library）全称是动态链接库，在 Windows 中，许多应用程序并不是一个完整的可执行文件，它们被分割成一些相对独立的动态链接库，即 DLL 文件，放置于系统中。当我们执行某一个程序时，相应的 DLL 文件就会被调用。</p></blockquote><p>DllPlugin 和 DllReferencePlugin 主要功能是可以将可共享且不经常改变的代码，抽取成一个共享的库，避免进行二次构建，同时也对构建时间进行优化。</p><p>通常来说，我们的代码都可以至少简单区分成业务代码和第三方库。如果不做处理，每次构建时都需要把所有的代码重新构建一次，耗费大量的时间。然后大部分情况下，很多第三方库的代码并不会发生变更（除非是版本升级），这时就可以用到 dll：把复用性较高的第三方模块打包到动态链接库中，在不升级这些库的情况下，动态库不需要重新打包，每次构建只重新打包业务代码。</p><h4 id="使用-dllplugin-打包需要分离到动态库的模块"><a aria-hidden="true" tabindex="-1" href="/black-webpack-guidebook//basic/core/plugins#使用-dllplugin-打包需要分离到动态库的模块"><span class="icon icon-link"></span></a>使用 DllPlugin 打包需要分离到动态库的模块</h4><p>配置示例：</p><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment">// webpack.dll.config.js</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">module</span><span class="token punctuation">.</span><span class="token property-access">exports</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  entry </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token comment">// 第三方库</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token literal-property property">react</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token string">&#x27;react&#x27;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&#x27;react-dom&#x27;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&#x27;react-redux&#x27;</span><span class="token punctuation">]</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token literal-property property">output</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token comment">// 输出的动态链接库的文件名称，[name] 代表当前动态链接库的名称</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token literal-property property">filename</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&#x27;[name].dll.js&#x27;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token literal-property property">path</span><span class="token operator">:</span><span class="token plain"> </span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">&#x27;dist/dll&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token comment">// library 必须和后面 DllPlugin 的 name 一致</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token literal-property property">library</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&#x27;[name]_dll_[hash]&#x27;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token literal-property property">plugins</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token comment">// 接入 DllPlugin</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token keyword">new</span><span class="token plain"> </span><span class="token class-name">webpack</span><span class="token class-name punctuation">.</span><span class="token class-name">DllPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token comment">// 动态链接库的全局变量名称，需要和 output.library 中保持一致</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token comment">// 该字段的值也就是输出的 manifest.json 文件中 name 字段的值</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token literal-property property">name</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&#x27;[name]_dll_[hash]&#x27;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token comment">// 描述动态链接库的 manifest.json 文件输出时的文件名称</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token literal-property property">path</span><span class="token operator">:</span><span class="token plain"> path</span><span class="token punctuation">.</span><span class="token method function property-access">join</span><span class="token punctuation">(</span><span class="token plain">__dirname</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&#x27;dist/dll&#x27;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&#x27;[name].manifest.json&#x27;</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">]</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">;</span></div></pre></div><h4 id="在主构建配置文件中使用动态库文件"><a aria-hidden="true" tabindex="-1" href="/black-webpack-guidebook//basic/core/plugins#在主构建配置文件中使用动态库文件"><span class="icon icon-link"></span></a>在主构建配置文件中使用动态库文件</h4><p>在 <code>webpack.config.js</code> 中使用 dll 要用到 DllReferencePlugin，这个插件通过引用 dll 的 manifest 文件来把依赖的名称映射到模块的 <code>id</code> 上，之后再在需要的时候通过内置的 <code>webpack_require</code> 函数来 <code>require</code> 他们。</p><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token keyword">new</span><span class="token plain"> </span><span class="token class-name">webpack</span><span class="token class-name punctuation">.</span><span class="token class-name">DllReferenncePlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token literal-property property">context</span><span class="token operator">:</span><span class="token plain"> __dirname</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token literal-property property">manifest</span><span class="token operator">:</span><span class="token plain"> </span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;./dist/dll/react.manifest.json&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div></pre></div><p>第一步产出的 <code>manifest</code> 文件就用在这里，给主构建流程作为查找 dll 的依据：DllReferencePlugin 去 <code>manifest.json</code> 文件读取 <code>name</code> 字段的值，把值的内容作为在全局变量中获取动态链接库中内容时的全局变量名，因此：在 <code>webpack_dll.config.js</code> 文件中，DllPlugin 中的 <code>name</code> 参数必须和 <code>output.library</code> 中保持一致。</p><h4 id="在入口文件引入-dll-文件"><a aria-hidden="true" tabindex="-1" href="/black-webpack-guidebook//basic/core/plugins#在入口文件引入-dll-文件"><span class="icon icon-link"></span></a>在入口文件引入 dll 文件</h4><p>生成的 dll 暴露出的是全局函数，因此还需要在入口文件中引入对应的 dll 文件。（也可以使用 AddAssetHtmlPlugin，将打包好的 DLL 库引入到 HTML 模版中）</p><div class="__dumi-default-code-block"><pre class="prism-code language-html"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token tag punctuation">&lt;</span><span class="token tag">body</span><span class="token tag punctuation">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token tag punctuation">&lt;</span><span class="token tag">div</span><span class="token tag"> </span><span class="token tag attr-name">id</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag attr-value">app</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag punctuation">&gt;</span><span class="token tag punctuation">&lt;/</span><span class="token tag">div</span><span class="token tag punctuation">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token tag punctuation">&lt;</span><span class="token tag">script</span><span class="token tag"> </span><span class="token tag attr-name">src</span><span class="token tag attr-value punctuation attr-equals">=</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag attr-value">../../dist/dll/react.dll.js</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag punctuation">&gt;</span><span class="token script"></span><span class="token tag punctuation">&lt;/</span><span class="token tag">script</span><span class="token tag punctuation">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token tag punctuation">&lt;/</span><span class="token tag">body</span><span class="token tag punctuation">&gt;</span></div></pre></div><p>作用：</p><ul><li><strong>分离代码</strong>：业务代码和第三方模块可以被单独打包到不同的文件中<ul><li>避免打包出单个文件的大小太大，不利于调试</li><li>将单个大文件拆分成多个小文件之后，一定情况下有利于加载（不超过浏览器一次性请求的文件数的情况下，并行下载肯定比串行快）</li></ul></li><li><strong>提升构建速度</strong>：第三方库代码没有变更时，由于我们只构建业务相关代码，相比全部重新构建自然要快得多</li></ul><p>参考资料：</p><ul><li><a target="_blank" rel="noopener noreferrer" href="https://segmentfault.com/a/1190000016567986">Webpack 使用 - 详解 DllPlugin<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul><h3 id="ignoreplugin"><a aria-hidden="true" tabindex="-1" href="/black-webpack-guidebook//basic/core/plugins#ignoreplugin"><span class="icon icon-link"></span></a>IgnorePlugin</h3><p>IgnorePlugin 用于在 Webpack 构建过程中忽略第三方模块的指定目录，避免将指定目录被打包。</p><p>语法：</p><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token keyword">new</span><span class="token plain"> </span><span class="token class-name">webpack</span><span class="token class-name punctuation">.</span><span class="token class-name">IgnorePlugin</span><span class="token punctuation">(</span><span class="token plain">requestRegExp</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token plain">contextRegExp</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div></pre></div><p>参数说明：</p><ul><li><code>requestRegExp</code>：匹配（test）资源请求路径的正则表达式</li><li><code>contextRegExp</code>：（可选）匹配（test）资源上下文（目录）的正则表达式</li></ul><p>配置示例：</p><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">module</span><span class="token punctuation">.</span><span class="token property-access">exports</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token literal-property property">plugins</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token keyword">new</span><span class="token plain"> </span><span class="token class-name">webpack</span><span class="token class-name punctuation">.</span><span class="token class-name">IgnorePlugin</span><span class="token punctuation">(</span><span class="token regex regex-delimiter">/</span><span class="token regex regex-source language-regex">^\.\/locale$</span><span class="token regex regex-delimiter">/</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token regex regex-delimiter">/</span><span class="token regex regex-source language-regex">moment$</span><span class="token regex regex-delimiter">/</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">;</span></div></pre></div><h3 id="hotmodulereplacementplugin"><a aria-hidden="true" tabindex="-1" href="/black-webpack-guidebook//basic/core/plugins#hotmodulereplacementplugin"><span class="icon icon-link"></span></a>HotModuleReplacementPlugin</h3><p>HotModuleReplacementPlugin 用于热更新替换。</p><h3 id="webpackbundleanalyzer"><a aria-hidden="true" tabindex="-1" href="/black-webpack-guidebook//basic/core/plugins#webpackbundleanalyzer"><span class="icon icon-link"></span></a>WebpackBundleAnalyzer</h3><p>WebpackBundleAnalyzer 用于构建结果分析。有利于我们快速查找包过大、内容是否重复、问题定位优化等。</p><ul><li><code>analyzerHost</code> <code>analyzerPort</code>：自定义配置打开的地址、端口，默认使用 <code>127.0.0.1:8888</code></li><li><code>reportFilename</code>：报告生成的路径，默认以项目的 <code>output.path</code> 输出</li><li><code>openAnalyzer</code>：是否要自动打开分析窗口</li></ul><h3 id="内部插件"><a aria-hidden="true" tabindex="-1" href="/black-webpack-guidebook//basic/core/plugins#内部插件"><span class="icon icon-link"></span></a>内部插件</h3><blockquote><p>只有在你基于 Webpack 构建自己的编译器时，你才应该关心它们</p></blockquote><h2 id="社区生态"><a aria-hidden="true" tabindex="-1" href="/black-webpack-guidebook//basic/core/plugins#社区生态"><span class="icon icon-link"></span></a>社区生态</h2><ul><li>HtmlWebpackPlugin</li><li>CompressionWebpackPlugin</li><li>CopyWebpackPlugin</li><li>CssMinimizerWebpackPlugin</li><li>EslintWebpackPlugin</li><li>HtmlMinimizerWebpckPlugin</li><li>ImageMinimizerWebpackPlugin</li><li>InstallWebpackPlugin</li><li>JsonMinimizerWebpackPlugin</li><li>MiniCssExtractPlugin</li><li>StylelintWebpackPlugin</li><li>TerserWebpackPlugin</li></ul><h3 id="htmlwebpackplugin"><a aria-hidden="true" tabindex="-1" href="/black-webpack-guidebook//basic/core/plugins#htmlwebpackplugin"><span class="icon icon-link"></span></a>HtmlWebpackPlugin</h3><p><a target="_blank" rel="noopener noreferrer" href="https://github.com/jantimon/html-webpack-plugin">HtmlWebpackPlugin<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 用于插入引用，根据模版生成 HTML。</p><p>配置示例：</p><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token keyword">new</span><span class="token plain"> </span><span class="token class-name">HtmlWebPackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token comment">// 表示输出的文件名</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token literal-property property">filename</span><span class="token operator">:</span><span class="token plain"> path</span><span class="token punctuation">.</span><span class="token method function property-access">resolve</span><span class="token punctuation">(</span><span class="token plain">__dirname</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&#x27;../assets/index.html&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token comment">// 模版文件</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token literal-property property">template</span><span class="token operator">:</span><span class="token plain"> path</span><span class="token punctuation">.</span><span class="token method function property-access">resolve</span><span class="token punctuation">(</span><span class="token plain">__dirname</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&#x27;../views/temp.html&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token comment">// 压缩 HTML 文件</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token literal-property property">minify</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token comment">// 移除 HTML 中的注释</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token literal-property property">removeComments</span><span class="token operator">:</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token comment">// 删除空白符与换行符</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token literal-property property">collapseWhitespace</span><span class="token operator">:</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token comment">// 插入到 HTML 的 CSS 和 JS 文件要内联，即不是以 &lt;link&gt;、&lt;script&gt; 形式引入</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token literal-property property">inlineSource</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&#x27;.(js|css)&#x27;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token comment">// 是否能注入内容到输出的页面</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token literal-property property">inject</span><span class="token operator">:</span><span class="token plain"> </span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token comment">// 指定插入某些模块</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token literal-property property">chunks</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token string">&#x27;vendors&#x27;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&#x27;index&#x27;</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token comment">// 每次会在插入的文件后面加上 hash 值，用于处理缓存</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token literal-property property">hash</span><span class="token operator">:</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token comment">// favicon、meta、title等都可以配置，页面内使用「&lt;%= htmlWebpackPlugin.options.title %&gt;」即可</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div></pre></div><h3 id="preloadwebpackplugin"><a aria-hidden="true" tabindex="-1" href="/black-webpack-guidebook//basic/core/plugins#preloadwebpackplugin"><span class="icon icon-link"></span></a>PreloadWebpackPlugin</h3><p><a target="_blank" rel="noopener noreferrer" href="https://github.com/vuejs/preload-webpack-plugin">PreloadWebpackPlugin<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 用于预加载资源。匹配其他页面可能用到的资源进行预先加载。该插件要求必须使用 Webpack 2.2+ 且必须使用 <a target="_blank" rel="noopener noreferrer" href="https://github.com/jantimon/html-webpack-plugin">HtmlWebpackPlugin<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</p><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token keyword">const</span><span class="token plain"> </span><span class="token maybe-class-name">HtmlWebpackPlugin</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;html-webpack-lugin&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">const</span><span class="token plain"> </span><span class="token maybe-class-name">PreloadWebpackPlugin</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;@vue/preload-webpack-plugin&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain">module</span><span class="token punctuation">.</span><span class="token property-access">exports</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token literal-property property">plugins</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token comment">// 必须在 PreloadWebpackPlugin 前实例化 HtmlWebpackPlugin</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token keyword">new</span><span class="token plain"> </span><span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token keyword">new</span><span class="token plain"> </span><span class="token class-name">PreloadWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token literal-property property">rel</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&#x27;preload&#x27;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token keyword module">as</span><span class="token punctuation">(</span><span class="token plain">entry</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token keyword control-flow">if</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token regex regex-delimiter">/</span><span class="token regex regex-source language-regex">\.css$</span><span class="token regex regex-delimiter">/</span><span class="token punctuation">.</span><span class="token method function property-access">test</span><span class="token punctuation">(</span><span class="token plain">entry</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token keyword control-flow">return</span><span class="token plain"> </span><span class="token string">&#x27;style&#x27;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token keyword control-flow">if</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token regex regex-delimiter">/</span><span class="token regex regex-source language-regex">\.woff$</span><span class="token regex regex-delimiter">/</span><span class="token punctuation">.</span><span class="token method function property-access">test</span><span class="token punctuation">(</span><span class="token plain">entry</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token keyword control-flow">return</span><span class="token plain"> </span><span class="token string">&#x27;font&#x27;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token keyword control-flow">if</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token regex regex-delimiter">/</span><span class="token regex regex-source language-regex">\.png$</span><span class="token regex regex-delimiter">/</span><span class="token punctuation">.</span><span class="token method function property-access">test</span><span class="token punctuation">(</span><span class="token plain">entry</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token keyword control-flow">return</span><span class="token plain"> </span><span class="token string">&#x27;image&#x27;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token keyword control-flow">return</span><span class="token plain"> </span><span class="token string">&#x27;script&#x27;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">;</span></div></pre></div><br/><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">module</span><span class="token punctuation">.</span><span class="token property-access">exports</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token literal-property property">plugins</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token keyword">new</span><span class="token plain"> </span><span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token keyword">new</span><span class="token plain"> </span><span class="token class-name">PreloadWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token literal-property property">rel</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&#x27;prefetch&#x27;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token keyword module">as</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&#x27;script&#x27;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token literal-property property">include</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&#x27;asyncChunks&#x27;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token literal-property property">fileBlackList</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token regex regex-delimiter">/</span><span class="token regex regex-source language-regex">\index.css|index.js|vendors.js]</span><span class="token regex regex-delimiter">/</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token regex regex-delimiter">/</span><span class="token regex regex-source language-regex">\.whatever</span><span class="token regex regex-delimiter">/</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">]</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span></div></pre></div><h3 id="htmlminimizerwebpackplugin"><a aria-hidden="true" tabindex="-1" href="/black-webpack-guidebook//basic/core/plugins#htmlminimizerwebpackplugin"><span class="icon icon-link"></span></a>HtmlMinimizerWebpackPlugin</h3><p><a target="_blank" rel="noopener noreferrer" href="https://webpack.js.org/plugins/html-minimizer-webpack-plugin/">HtmlMinimizerWebpackPlugin<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 用于 <code>optimization.minimizer</code> 优化压缩 HTML 文件。</p><p>配置示例：</p><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token keyword">const</span><span class="token plain"> </span><span class="token maybe-class-name">HtmlMinimizerPlugin</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;html-minimizer-webpack-plugin&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">const</span><span class="token plain"> </span><span class="token maybe-class-name">CopyPlugin</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;copy-webpack-plugin&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain">module</span><span class="token punctuation">.</span><span class="token property-access">exports</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token literal-property property">module</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token literal-property property">loaders</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token literal-property property">test</span><span class="token operator">:</span><span class="token plain"> </span><span class="token regex regex-delimiter">/</span><span class="token regex regex-source language-regex">\.html$</span><span class="token regex regex-delimiter">/</span><span class="token regex regex-flags">i</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token literal-property property">type</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&#x27;asset/resource&#x27;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token literal-property property">plugins</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token keyword">new</span><span class="token plain"> </span><span class="token class-name">CopyPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token literal-property property">patterns</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">          </span><span class="token literal-property property">context</span><span class="token operator">:</span><span class="token plain"> path</span><span class="token punctuation">.</span><span class="token method function property-access">resolve</span><span class="token punctuation">(</span><span class="token plain">__dirname</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&#x27;dist&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">          </span><span class="token keyword module">from</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&#x27;./src/*.html&#x27;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token literal-property property">optimization</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token literal-property property">minimize</span><span class="token operator">:</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token literal-property property">minimizer</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token comment">// For webpack@5 you can use the `...` syntax to extend existing minimizers (i.e. `terser-webpack-plugin`), uncomment the next line</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token comment">// `...`</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token keyword">new</span><span class="token plain"> </span><span class="token class-name">HtmlMinimizerPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">;</span></div></pre></div><p>说明：</p><ul><li>允许自定义压缩代码</li><li>允许开启多线程提升构建速度（<code>parallel = true</code> 默认开启）</li><li>压缩选项参考 <a target="_blank" rel="noopener noreferrer" href="https://github.com/terser/html-minifier-terser">html-minifier-terser<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 提供的选项</li><li>压缩选项包含去除注释、空标签属性、指定标签元等等</li></ul><h3 id="cssminimizerwebpackplugin"><a aria-hidden="true" tabindex="-1" href="/black-webpack-guidebook//basic/core/plugins#cssminimizerwebpackplugin"><span class="icon icon-link"></span></a>CssMinimizerWebpackPlugin</h3><p>CssMinimizerWebpackPlugin 使用 <a target="_blank" rel="noopener noreferrer" href="https://cssnano.co/">cssnano<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 优化和压缩 CSS 文件。就像 <a target="_blank" rel="noopener noreferrer" href="https://github.com/NMFR/optimize-css-assets-webpack-plugin">optimize-css-assets-webpack-plugin<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 一样，但能够使用查询字符串更准确地索引地图和资产，允许缓存和并行模式工作。</p><p>配置示例：</p><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token keyword">const</span><span class="token plain"> </span><span class="token maybe-class-name">CssMinimizerPlugin</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;css-minimizer-webpack-plugin&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain">module</span><span class="token punctuation">.</span><span class="token property-access">exports</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token literal-property property">devtool</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&#x27;source-map&#x27;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token literal-property property">module</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token literal-property property">loaders</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token literal-property property">test</span><span class="token operator">:</span><span class="token plain"> </span><span class="token regex regex-delimiter">/</span><span class="token regex regex-source language-regex">.s?css$</span><span class="token regex regex-delimiter">/</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token literal-property property">use</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">          </span><span class="token maybe-class-name">MiniCssExtractPlugin</span><span class="token punctuation">.</span><span class="token property-access">loader</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">          </span><span class="token punctuation">{</span><span class="token plain"> </span><span class="token literal-property property">loader</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&#x27;css-loader&#x27;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token literal-property property">options</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"> </span><span class="token literal-property property">sourceMap</span><span class="token operator">:</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token plain"> </span><span class="token punctuation">}</span><span class="token plain"> </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">          </span><span class="token punctuation">{</span><span class="token plain"> </span><span class="token literal-property property">loader</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&#x27;sass-loader&#x27;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token literal-property property">options</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"> </span><span class="token literal-property property">sourceMap</span><span class="token operator">:</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token plain"> </span><span class="token punctuation">}</span><span class="token plain"> </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token literal-property property">optimization</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token literal-property property">minimizer</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token keyword">new</span><span class="token plain"> </span><span class="token class-name">CssMinimizerPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token literal-property property">plugins</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token keyword">new</span><span class="token plain"> </span><span class="token class-name">MiniCssExtractPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">;</span></div></pre></div><h3 id="minicssextractplugin"><a aria-hidden="true" tabindex="-1" href="/black-webpack-guidebook//basic/core/plugins#minicssextractplugin"><span class="icon icon-link"></span></a>MiniCssExtractPlugin</h3><p><strong>用于提取 CSS</strong></p><ul><li><code>extract-text-webpack-plugin</code> 根据创建实例或配置多个入口 chunk</li></ul><p>比如一个入口文件 =&gt; 所有 CSS 提取在一个样式文件里</p><ul><li><code>min-css-extract-plugin</code> 默认对样式进行模块拆分。</li></ul><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment">// extract-text-webpack-plugin</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">config</span><span class="token punctuation">.</span><span class="token property-access">module</span><span class="token punctuation">.</span><span class="token property-access">rules</span><span class="token punctuation">.</span><span class="token method function property-access">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token literal-property property">test</span><span class="token operator">:</span><span class="token plain"> </span><span class="token regex regex-delimiter">/</span><span class="token regex regex-source language-regex">\.(scs|sas|cs)s$</span><span class="token regex regex-delimiter">/</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token literal-property property">use</span><span class="token operator">:</span><span class="token plain"> </span><span class="token maybe-class-name">ExtractTextPlugin</span><span class="token punctuation">.</span><span class="token method function property-access">extrac</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token literal-property property">use</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token string">&#x27;css-loader&#x27;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token literal-property property">loader</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&#x27;postcss-loader&#x27;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token literal-property property">options</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">          </span><span class="token literal-property property">plugins</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">            </span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;autoprefixer&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">              </span><span class="token comment">// 添加前缀</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">              </span><span class="token literal-property property">browsers</span><span class="token operator">:</span><span class="token plain"> </span><span class="token constant">CSS_BROWSERS</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">            </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">          </span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">          </span><span class="token literal-property property">minimize</span><span class="token operator">:</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token string">&#x27;sass-loader&#x27;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">config</span><span class="token punctuation">.</span><span class="token property-access">plugins</span><span class="token punctuation">.</span><span class="token method function property-access">push</span><span class="token punctuation">(</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword">new</span><span class="token plain"> </span><span class="token class-name">ExtractTextPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token literal-property property">filename</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&#x27;css/[name].css&#x27;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token literal-property property">disable</span><span class="token operator">:</span><span class="token plain"> </span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token literal-property property">allChunks</span><span class="token operator">:</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">)</span><span class="token punctuation">;</span></div></pre></div><p><code>postcss-loader</code> 用于与已有工具集成一起使用，很少有单独使用。</p><p>通常会配合 <code>autoprefixer</code> 来添加个浏览器的前缀，以达到更好的兼容。</p><p>在深入就是 <code>cssnext</code> 允许开发者自定义属性和变量。</p><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment">// mini-css-extract-plugin</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">config</span><span class="token punctuation">.</span><span class="token property-access">module</span><span class="token punctuation">.</span><span class="token property-access">rules</span><span class="token punctuation">.</span><span class="token method function property-access">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token literal-property property">test</span><span class="token operator">:</span><span class="token plain"> </span><span class="token regex regex-delimiter">/</span><span class="token regex regex-source language-regex">\.(scs|cs)s$</span><span class="token regex regex-delimiter">/</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token literal-property property">use</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">            </span><span class="token literal-property property">loader</span><span class="token operator">:</span><span class="token plain"> </span><span class="token maybe-class-name">MiniExtractPlugin</span><span class="token punctuation">.</span><span class="token property-access">loader</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token string">&quot;css-loader&quot;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">            </span><span class="token literal-property property">loader</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&#x27;postcss-loader&#x27;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">            </span><span class="token literal-property property">options</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">                </span><span class="token literal-property property">plugins</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">                    </span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;autofixer&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">                        </span><span class="token literal-property property">browsers</span><span class="token operator">:</span><span class="token plain"> </span><span class="token constant">CSS_BROWSERS</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">                    </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">                </span><span class="token punctuation">]</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">            </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token punctuation">}</span><span class="token plain">，</span></div><div class="token-line"><span class="token plain">        </span><span class="token string">&quot;sass-loader&quot;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">]</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">)</span></div></pre></div><h3 id="imageminimizerwebpackplugin"><a aria-hidden="true" tabindex="-1" href="/black-webpack-guidebook//basic/core/plugins#imageminimizerwebpackplugin"><span class="icon icon-link"></span></a>ImageMinimizerWebpackPlugin</h3><p><a target="_blank" rel="noopener noreferrer" href="https://webpack.js.org/plugins/image-minimizer-webpack-plugin/">ImageMinimizerWebpackPlugin<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p><p>该插件提供两种工具压缩图片：</p><ul><li><a target="_blank" rel="noopener noreferrer" href="https://github.com/imagemin/imagemin">imagemin<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>：默认的优化图片方式，因为它是稳定的，适用于所有类型的图像</li><li><a target="_blank" rel="noopener noreferrer" href="https://github.com/GoogleChromeLabs/squoosh/tree/dev/libsquoosh">squoosh<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>：在实验模式下使用 <code>.jpg</code>、<code>.jpeg</code>、<code>.png</code>、<code>.webp</code> 和 <code>.avif</code> 文件类型时</li></ul><p>该插件提供两种运行模式：</p><ul><li><a target="_blank" rel="noopener noreferrer" href="https://en.wikipedia.org/wiki/Lossless_compression">Lossless<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>：无损画像质量</li><li><a target="_blank" rel="noopener noreferrer" href="https://en.wikipedia.org/wiki/Lossy_compression">Lossy<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>：画像质量下降</li></ul><h4 id="使用-imagemin-优化"><a aria-hidden="true" tabindex="-1" href="/black-webpack-guidebook//basic/core/plugins#使用-imagemin-优化"><span class="icon icon-link"></span></a>使用 imagemin 优化</h4><p>需要先安装模式所对应的模块：</p><div class="__dumi-default-code-block"><pre class="prism-code language-bash"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment"># lossless</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">npm</span><span class="token plain"> </span><span class="token function">install</span><span class="token plain"> imagemin-gifsicle imagemin-jpegtran imagemin-optipg imagemin-svgo --save-dev</span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain"></span><span class="token comment"># lossy</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">npm</span><span class="token plain"> </span><span class="token function">install</span><span class="token plain"> imagemin-gifsicle imagemin-mozjpeg imagemin-pngquant imagemin-svgo --save-dev</span></div></pre></div><p>配置示例：</p><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token keyword">const</span><span class="token plain"> </span><span class="token maybe-class-name">ImageMinimizerPlugin</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;image-minimizer-webpack-plugin&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">const</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"> extendDefaultPlugins </span><span class="token punctuation">}</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;svgo&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain">module</span><span class="token punctuation">.</span><span class="token property-access">exports</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token literal-property property">module</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token literal-property property">rules</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token literal-property property">test</span><span class="token operator">:</span><span class="token plain"> </span><span class="token regex regex-delimiter">/</span><span class="token regex regex-source language-regex">\.(jpe?g|png|gif|svg)$</span><span class="token regex regex-delimiter">/</span><span class="token regex regex-flags">i</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token literal-property property">type</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&#x27;asset&#x27;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token literal-property property">plugins</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token keyword">new</span><span class="token plain"> </span><span class="token class-name">ImageMinimizerPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token literal-property property">minimizerOptions</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token comment">// Lossless optimization with custom option</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token comment">// Feel free to experiment with options for better result for you</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token literal-property property">plugins</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">          </span><span class="token punctuation">[</span><span class="token string">&#x27;gifsicle&#x27;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"> </span><span class="token literal-property property">interlaced</span><span class="token operator">:</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token plain"> </span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">          </span><span class="token punctuation">[</span><span class="token string">&#x27;jpegtran&#x27;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"> </span><span class="token literal-property property">progressive</span><span class="token operator">:</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token plain"> </span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">          </span><span class="token punctuation">[</span><span class="token string">&#x27;optipng&#x27;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"> </span><span class="token literal-property property">optimizationLevel</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">5</span><span class="token plain"> </span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">          </span><span class="token comment">// Svgo configuration here https://github.com/svg/svgo#configuration</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">          </span><span class="token punctuation">[</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">            </span><span class="token string">&#x27;svgo&#x27;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">            </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">              </span><span class="token literal-property property">plugins</span><span class="token operator">:</span><span class="token plain"> </span><span class="token function">extendDefaultPlugins</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">                </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">                  </span><span class="token literal-property property">name</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&#x27;removeViewBox&#x27;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">                  </span><span class="token literal-property property">active</span><span class="token operator">:</span><span class="token plain"> </span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">                </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">                </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">                  </span><span class="token literal-property property">name</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&#x27;addAttributesToSVGElement&#x27;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">                  </span><span class="token literal-property property">params</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">                    </span><span class="token literal-property property">attributes</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token plain"> </span><span class="token literal-property property">xmlns</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&#x27;http://www.w3.org/2000/svg&#x27;</span><span class="token plain"> </span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">                  </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">                </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">              </span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">            </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">          </span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">;</span></div></pre></div><h4 id="使用-squoosh-优化"><a aria-hidden="true" tabindex="-1" href="/black-webpack-guidebook//basic/core/plugins#使用-squoosh-优化"><span class="icon icon-link"></span></a>使用 squoosh 优化</h4><p>同样需要先安装扩展模块：</p><div class="__dumi-default-code-block"><pre class="prism-code language-bash"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token function">npm</span><span class="token plain"> </span><span class="token function">install</span><span class="token plain"> @squoosh/lib --save-dev</span></div></pre></div><p>配置示例：</p><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token keyword">const</span><span class="token plain"> </span><span class="token maybe-class-name">ImageMinimizerPlugin</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;image-minimizer-webpack-plugin&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain">module</span><span class="token punctuation">.</span><span class="token property-access">exports</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token literal-property property">module</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token literal-property property">rules</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token literal-property property">test</span><span class="token operator">:</span><span class="token plain"> </span><span class="token regex regex-delimiter">/</span><span class="token regex regex-source language-regex">\.(jpe?g|png)$</span><span class="token regex regex-delimiter">/</span><span class="token regex regex-flags">i</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token literal-property property">type</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&#x27;asset&#x27;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token literal-property property">plugins</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token keyword">new</span><span class="token plain"> </span><span class="token class-name">ImageMinimizerPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token literal-property property">minify</span><span class="token operator">:</span><span class="token plain"> </span><span class="token maybe-class-name">ImageMinimizerPlugin</span><span class="token punctuation">.</span><span class="token property-access">squooshMinify</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token literal-property property">minimizerOptions</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token literal-property property">encodeOptions</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">          </span><span class="token literal-property property">mozjpeg</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">            </span><span class="token comment">// That setting might be close to lossless, but it’s not guaranteed</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">            </span><span class="token comment">// https://github.com/GoogleChromeLabs/squoosh/issues/85</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">            </span><span class="token literal-property property">quality</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">100</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">          </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">          </span><span class="token literal-property property">webp</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">            </span><span class="token literal-property property">lossless</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">          </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">          </span><span class="token literal-property property">avif</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">            </span><span class="token comment">// https://github.com/GoogleChromeLabs/squoosh/blob/dev/codecs/avif/enc/README.md</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">            </span><span class="token literal-property property">cqLevel</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">          </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">;</span></div></pre></div><h3 id="terserwebpackplugin"><a aria-hidden="true" tabindex="-1" href="/black-webpack-guidebook//basic/core/plugins#terserwebpackplugin"><span class="icon icon-link"></span></a>TerserWebpackPlugin</h3><p><a target="_blank" rel="noopener noreferrer" href="https://webpack.js.org/plugins/terser-webpack-plugin/">TerserWebpackPlugin<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 用于优化和压缩 JavaScript 文件。默认使用 <a target="_blank" rel="noopener noreferrer" href="https://github.com/terser/terser">terser<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 模块包进行压缩。</p><p>配置示例：</p><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token keyword">const</span><span class="token plain"> </span><span class="token maybe-class-name">TerserPlugin</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;terser-webpack-plugin&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain">module</span><span class="token punctuation">.</span><span class="token property-access">exports</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token literal-property property">optimization</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token literal-property property">minimizer</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token keyword">new</span><span class="token plain"> </span><span class="token class-name">TerserPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token comment">// 并行</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token literal-property property">parallel</span><span class="token operator">:</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token literal-property property">terserOptions</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">          </span><span class="token literal-property property">compress</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">            </span><span class="token literal-property property">ecma</span><span class="token operator">:</span><span class="token plain"> </span><span class="token keyword nil">undefined</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">            </span><span class="token literal-property property">parse</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">            </span><span class="token literal-property property">compress</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">            </span><span class="token literal-property property">mangle</span><span class="token operator">:</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">            </span><span class="token literal-property property">module</span><span class="token operator">:</span><span class="token plain"> </span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">            </span><span class="token comment">// 丢掉 console，减少内存泄漏</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">            </span><span class="token literal-property property">drop_console</span><span class="token operator">:</span><span class="token plain"> </span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">          </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token comment">// 压缩注释（或使用正则匹配或函数判断）</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token literal-property property">extractComments</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&#x27;all&#x27;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">;</span></div></pre></div><br/><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment">// 保留注释</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">module</span><span class="token punctuation">.</span><span class="token property-access">exports</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token literal-property property">optimization</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token literal-property property">minimize</span><span class="token operator">:</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token literal-property property">minimizer</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token keyword">new</span><span class="token plain"> </span><span class="token class-name">TerserPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token literal-property property">terserOptions</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">          </span><span class="token literal-property property">format</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">            </span><span class="token literal-property property">comments</span><span class="token operator">:</span><span class="token plain"> </span><span class="token regex regex-delimiter">/</span><span class="token regex regex-source language-regex">@license</span><span class="token regex regex-delimiter">/</span><span class="token regex regex-flags">i</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">          </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token literal-property property">extractComments</span><span class="token operator">:</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">;</span></div></pre></div><br/><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment">// 移除注释</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">module</span><span class="token punctuation">.</span><span class="token property-access">exports</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token literal-property property">optimization</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token literal-property property">minimize</span><span class="token operator">:</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token literal-property property">minimizer</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token keyword">new</span><span class="token plain"> </span><span class="token class-name">TerserPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token literal-property property">terserOptions</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">          </span><span class="token literal-property property">format</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">            </span><span class="token literal-property property">comments</span><span class="token operator">:</span><span class="token plain"> </span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">          </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token literal-property property">extractComments</span><span class="token operator">:</span><span class="token plain"> </span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">;</span></div></pre></div><br/><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment">// 混淆压缩</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">module</span><span class="token punctuation">.</span><span class="token property-access">exports</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token literal-property property">optimization</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token literal-property property">minimize</span><span class="token operator">:</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token literal-property property">minimizer</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token keyword">new</span><span class="token plain"> </span><span class="token class-name">TerserPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token literal-property property">minify</span><span class="token operator">:</span><span class="token plain"> </span><span class="token maybe-class-name">TerserPlugin</span><span class="token punctuation">.</span><span class="token property-access">uglifyJsMinify</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token comment">// `terserOptions` options will be passed to `uglify-js`</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token comment">// Link to options - https://github.com/mishoo/UglifyJS#minify-options</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token literal-property property">terserOptions</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">;</span></div></pre></div><br/><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token comment">// esbuild</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">module</span><span class="token punctuation">.</span><span class="token property-access">exports</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token literal-property property">optimization</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token literal-property property">minimize</span><span class="token operator">:</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token literal-property property">minimizer</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token keyword">new</span><span class="token plain"> </span><span class="token class-name">TerserPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token literal-property property">minify</span><span class="token operator">:</span><span class="token plain"> </span><span class="token maybe-class-name">TerserPlugin</span><span class="token punctuation">.</span><span class="token property-access">esbuildMinify</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token comment">// `terserOptions` options will be passed to `esbuild`</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token comment">// Link to options - https://esbuild.github.io/api/#minify</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token comment">// Note: the `minify` options is true by default (and override other `minify*` options), so if you want to disable the `minifyIdentifiers` option (or other `minify*` options) please use:</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token comment">// terserOptions: {</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token comment">//   minify: false,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token comment">//   minifyWhitespace: true,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token comment">//   minifyIdentifiers: false,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token comment">//   minifySyntax: true,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token comment">// },</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token literal-property property">terserOptions</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">;</span></div></pre></div><h3 id="compressionwebpackplugin"><a aria-hidden="true" tabindex="-1" href="/black-webpack-guidebook//basic/core/plugins#compressionwebpackplugin"><span class="icon icon-link"></span></a>CompressionWebpackPlugin</h3><p><a target="_blank" rel="noopener noreferrer" href="https://webpack.js.org/plugins/compression-webpack-plugin/">CompressionWebpackPlugin<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 用于通过命令行 <code>gz</code> 压缩静态资源包大小，提升前端加载性能与速度。该插件需要在服务端代理服务器（如 Nginx）支持 <code>gzip</code> 压缩配置。</p><p>配置示例：</p><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token keyword">const</span><span class="token plain"> zlib </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;zlib&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain">module</span><span class="token punctuation">.</span><span class="token property-access">exports</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token literal-property property">plugins</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token keyword">new</span><span class="token plain"> </span><span class="token class-name">CompressionPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token comment">// 生成文件名</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token literal-property property">filename</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&#x27;[path][base].gz&#x27;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token comment">// 压缩算法</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token literal-property property">algorithm</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&#x27;gzip&#x27;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token comment">// 需要压缩的文件（正则匹配）</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token literal-property property">test</span><span class="token operator">:</span><span class="token plain"> </span><span class="token regex regex-delimiter">/</span><span class="token regex regex-source language-regex">\.js$|\.css$|\.html$</span><span class="token regex regex-delimiter">/</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token comment">// 需要压缩资源的最低大小（单位：字节）</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token literal-property property">threshold</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">10240</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token comment">// 仅处理压缩效果优于此比率的资产</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token literal-property property">minRatio</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">0.8</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token keyword">new</span><span class="token plain"> </span><span class="token class-name">CompressionPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token literal-property property">filename</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&#x27;[path][base].br&#x27;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token literal-property property">algorithm</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&#x27;brotliCompress&#x27;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token literal-property property">test</span><span class="token operator">:</span><span class="token plain"> </span><span class="token regex regex-delimiter">/</span><span class="token regex regex-source language-regex">\.(js|css|html|svg)$</span><span class="token regex regex-delimiter">/</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token literal-property property">compressionOptions</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token literal-property property">params</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">          </span><span class="token punctuation">[</span><span class="token plain">zlib</span><span class="token punctuation">.</span><span class="token property-access">constants</span><span class="token punctuation">.</span><span class="token constant">BROTLI_PARAM_QUALITY</span><span class="token punctuation">]</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">11</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token literal-property property">threshold</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">10240</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token literal-property property">minRatio</span><span class="token operator">:</span><span class="token plain"> </span><span class="token number">0.8</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">;</span></div></pre></div><p>注意：</p><ul><li>某些资源构建后由于体积过小，不会进行压缩操作，可以通过调整 <code>threashold</code> 控制</li></ul><h3 id="copywebpackplugin"><a aria-hidden="true" tabindex="-1" href="/black-webpack-guidebook//basic/core/plugins#copywebpackplugin"><span class="icon icon-link"></span></a>CopyWebpackPlugin</h3><p>CopyWebpackPlugin 用于拷贝文件。</p><p>配置示例：</p><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token plain">module</span><span class="token punctuation">.</span><span class="token property-access">exports</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token literal-property property">plugins</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token keyword">new</span><span class="token plain"> </span><span class="token class-name">CopyPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token literal-property property">patterns</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token string">&#x27;relative/path/to/file.ext&#x27;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token string">&#x27;relative/path/to/dir&#x27;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        path</span><span class="token punctuation">.</span><span class="token method function property-access">resolve</span><span class="token punctuation">(</span><span class="token plain">__dirname</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&#x27;src&#x27;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&#x27;file.ext&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        path</span><span class="token punctuation">.</span><span class="token method function property-access">resolve</span><span class="token punctuation">(</span><span class="token plain">__dirname</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&#x27;src&#x27;</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&#x27;dir&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token string">&#x27;**/*&#x27;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">          </span><span class="token keyword module">from</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string">&#x27;**/*&#x27;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token comment">// If absolute path is a `glob` we replace backslashes with forward slashes, because only forward slashes can be used in the `glob`</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        path</span><span class="token punctuation">.</span><span class="token property-access">posix</span><span class="token punctuation">.</span><span class="token method function property-access">join</span><span class="token punctuation">(</span><span class="token plain">path</span><span class="token punctuation">.</span><span class="token method function property-access">resolve</span><span class="token punctuation">(</span><span class="token plain">__dirname</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&#x27;src&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">replace</span><span class="token punctuation">(</span><span class="token regex regex-delimiter">/</span><span class="token regex regex-source language-regex">\\</span><span class="token regex regex-delimiter">/</span><span class="token regex regex-flags">g</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&#x27;/&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token string">&#x27;*.txt&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">;</span></div></pre></div><h2 id="废弃插件"><a aria-hidden="true" tabindex="-1" href="/black-webpack-guidebook//basic/core/plugins#废弃插件"><span class="icon icon-link"></span></a>废弃插件</h2><h3 id="commonschunkplugin"><a aria-hidden="true" tabindex="-1" href="/black-webpack-guidebook//basic/core/plugins#commonschunkplugin"><span class="icon icon-link"></span></a>CommonsChunkPlugin</h3><p><a target="_blank" rel="noopener noreferrer" href="https://v4.webpack.js.org/plugins/commons-chunk-plugin/">CommonsChunkPlugin<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 用于创建一个单独的文件中（被称为块 Chunk），由多个入口点之间共享的公共模块。Webpack 5+ 后由 <a href="/black-webpack-guidebook//basic/core/plugins#terserwebpackplugin">TerserWebpackPlugin</a> 实现该部分功能。</p><p>通过将通用模块与捆绑包分离，所产生的分块文件可以在最初加载一次，并存储在缓存中供以后使用。这就导致了页面速度的优化，因为浏览器可以快速地从缓存中提供共享代码，而不是每当访问一个新页面时就被迫加载一个更大的捆绑包。</p><h3 id="uglifyjswebpackplugin"><a aria-hidden="true" tabindex="-1" href="/black-webpack-guidebook//basic/core/plugins#uglifyjswebpackplugin"><span class="icon icon-link"></span></a>UglifyjsWebpackPlugin</h3><p><a target="_blank" rel="noopener noreferrer" href="https://v4.webpack.js.org/plugins/uglifyjs-webpack-plugin/">UglifyjsWebpackPlugin<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 用于代码混淆和压缩。 在 Webpack v4.26.0+ 后，<code>uglify-es</code> 已不再维护，由 <a href="/black-webpack-guidebook//basic/core/plugins#terserwebpackplugin">TerserWebpackPlugin</a> fork 并维护。</p><p>配置示例：</p><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button class="__dumi-default-icon __dumi-default-code-block-copy-btn" data-status="ready"></button><div class="token-line"><span class="token keyword">const</span><span class="token plain"> </span><span class="token maybe-class-name">UglifyJsPlugin</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#x27;uglifyjs-webpack-plugin&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">
</span></div><div class="token-line"><span class="token plain">module</span><span class="token punctuation">.</span><span class="token property-access">exports</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token literal-property property">optimization</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token literal-property property">minimizer</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token keyword">new</span><span class="token plain"> </span><span class="token class-name">UglifyJsPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">;</span></div></pre></div></div><div class="__dumi-default-layout-footer-meta"><a target="_blank" rel="noopener noreferrer" href="https://github.com/yyt520/black-webpack-guidebook/edit/master/docs/basic/core/plugins.md">Edit this doc on GitHub<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><span data-updated-text="Last update: ">2023/7/9 17:43:15</span></div></div></div></div>
	<script>
  window.g_useSSR = true;
  window.g_initialProps = {};
	</script>

    <script src="/black-webpack-guidebook/umi.bff3bc49.js"></script>
  </body>
</html>
